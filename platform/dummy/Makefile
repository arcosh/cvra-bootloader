################################################################################

PROJNAME = bootloader_dummy

# where to place the build files
BUILD_DIR = build

# platform specific source files
PLATFORM_CSRC = platform.c

PROJ_ROOT = ../..
PLATFORM_PATH = platform/dummy/

include ../verbosity.mk

################################################################################

CC  = gcc
CXX = g++
AS  = gcc -x assembler-with-cpp
LD  = g++
AR  = ar
OC  = objcopy
OD  = objdump
NM  = nm
SZ  = size

MKDIR = mkdir -p

################################################################################

# Generated byte packager from template include.jinja
include include.mk

CSRC     += $(addprefix $(PLATFORM_PATH), $(PLATFORM_CSRC))

# Includes
INCDIR   := ./
INCDIR   += $(PROJ_ROOT)/
INCDIR   += $(addprefix $(PROJ_ROOT)/, $(PACKAGER_INCDIR))

OPTIMIZATION = -Og
DEBUGGING = -g
WARNINGS = -Wall -Wextra -Wno-unused-parameter

# C & C++ compiler flags
#CFLAGS   += -fno-common
#CFLAGS   += -ffunction-sections
#CFLAGS   += -fdata-sections
#CFLAGS   += -fno-exceptions
#CFLAGS   += -fomit-frame-pointer
CFLAGS   += $(OPTIMIZATION)
CFLAGS   += $(WARNINGS)
CFLAGS   += $(DEBUGGING)
CFLAGS   += $(DEFINES)
# Create header inclusion dependency files (*.d)
CFLAGS   += -MD
CFLAGS   += $(addprefix  -I, $(INCDIR))

# C only flags
CCFLAGS += -std=gnu99
#CCFLAGS  += -Wstrict-prototypes

# C++ only flags
#CXXFLAGS += -fno-rtti
#CXXFLAGS += -fno-exceptions
#CXXFLAGS += -fno-unwind-tables
#CXXFLAGS += -fno-use-cxa-atexit


#LIBS     += -Wl,-lc -Wl,-lgcc -Wl,-lnosys

# Linker flags
LFLAGS   += $(LIBS)
LFLAGS   += -Wl,-Map=$(PROJNAME).map
LFLAGS   += $(OPTIMIZATION)

CCFLAGS  += $(CFLAGS)
CXXFLAGS += $(CFLAGS)
ASMFLAGS += $(CFLAGS)

COBJS = $(addprefix $(BUILD_DIR)/, $(CSRC:.c=.o))
ASMOBJS = $(addprefix $(BUILD_DIR)/, $(ASMSRC:.s=.o))
CXXOBJS = $(addprefix $(BUILD_DIR)/, $(CXXSRC:.cpp=.o))

OBJS = $(COBJS) $(ASMOBJS) $(CXXOBJS)

#
# targets:
################################################################################

-include ../targets.mk
-include ../openocd.mk
